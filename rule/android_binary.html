<!doctype html><html xmlns="http://www.w3.org/1999/xhtml"><head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns#"><script>var loc = new String(window.location); if (loc.indexOf('facebook.github.io/buck') != -1) {window.location.replace(loc.replace('facebook.github.io/buck', 'buckbuild.com'));}</script><!-- Facebook Pixel Code --><script>!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,document,'script','//connect.facebook.net/en_US/fbevents.js'); fbq('init', '1637165926500152'); fbq('track', 'PageView');</script><noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=1637165926500152&ev=PageView&noscript=1" /></noscript><!-- End Facebook Pixel Code --><title>Buck: android_binary()</title><link type="image/png" rel="shortcut icon" href="/static/favicon.png" /><meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no" /><meta http-equiv="content-type" content="text/html;charset=utf-8"><link type="text/css" rel="stylesheet" href="/google-code-prettify/prettify.css" ><link type="text/css" rel="stylesheet" href="/static/buck.css"><link type="text/css" rel="stylesheet" href="/static/search.css"><link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" /><meta property="og:locale" content="en_US"><meta property="og:title" content="android_binary()"><meta property="og:site_name" content="Buck: a build tool"><meta property="og:image" content="http://buckbuild.com/static/og.png"><meta property="og:type" content="article"><meta property="og:description" content="A rule that generates an Android APK."><meta property="fb:admins" content="584556688222168"><script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-44373548-18', 'auto');
    ga('send', 'pageview');
  </script></head><body><div id="fb-root"></div><script>(function(d, s, id) {var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) return; js = d.createElement(s); js.id = id; js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=584556688222168"; fjs.parentNode.insertBefore(js, fjs);}(document, 'script', 'facebook-jssdk'));</script><header class='topbar'><nav class='width'><a href='http://buckbuild.com/'><h1>Buck</h1></a><ul class='menu'><li class="algolia-search-wrapper"><input id="algolia-doc-search" type="search" placeholder="Search docs..." /></li><li><a href='/setup/getting_started.html'>Getting Started</a><li><a href='https://groups.google.com/forum/#!forum/buck-build'>Group</a><li><a href='/javadoc/'>API</a><li><a href='https://github.com/facebook/buck'>GitHub</a></ul></nav></header><section class='content'><div class='width'><article><h1>android_binary()</h1><div class="overview">An <code>android_binary()</code> rule is used to generate an Android APK.<h2>Arguments</h2><ul class="arglist"><li class="arg"><code>name</code> (required) The name of the rule, as well as the name of the APK generated by this rule.<li class="arg"><code>manifest</code> (required) Relative path to the Android manifest for the APK.  The common case is that the manifest will be in the same directory as the rule, in which case this will simply be <code>'AndroidManifest.xml'</code>, but it can also reference an <a href="/rule/android_manifest.html"><code>android_manifest</code></a> rule.<li class="arg"><code>keystore</code> (required) A build target that identifies a <a href="/rule/keystore.html"><code>keystore</code></a> to use to sign the APK.<li class="arg"><code>package_type</code> (defaults to <code>&#39;debug&#39;</code>) Determines whether ProGuard will be used when packaging the APK. Acceptable values for <code>package_type</code> are <code>'debug'</code> and<code>'release'</code>. The default value is <code>'debug'</code>, which indicates that ProGuard should not be used.<p><strong>Note:</strong> This argument will be renamed to reflect that it determines the use of ProGuard.<li class="arg"><code>proguard_config</code> (defaults to <code>None</code>) Relative path to a ProGuard configuration file that will be passed via the <code>-include</code> flag when <code>package_type</code> is <code>'release'</code>.<li class="arg"><code>android_sdk_proguard_config</code> (defaults to <code>&#39;default&#39;</code>) The type of proguard configuration to use from the Android SDK. Options are <code>'default'</code> to use the default config,<code>'optimized'</code> to use the config with optimizations enabled, or <code>'none'</code> to not use any standard configuration (you will need to supply your own version, otherwise your app will probably not work).<li class="arg"><code>no_dx</code> (defaults to <code>[]</code>) List of build targets that may have been included during compilation of  the transitive <code>android_library()</code> and <code>java_library()</code> dependencies, but should not be included in the <code>classes.dex</code> for generated for the APK.<li class="arg"><code>build_config_values</code> (defaults to <code>[]</code>) See the documentation on the <tt>values</tt> argument for <a href="/rule/android_build_config.html"><code>android_build_config</code></a>.<li class="arg"><code>build_config_values_file</code> (defaults to <code>None</code>) See the documentation on the <tt>values_file</tt> argument for <a href="/rule/android_build_config.html"><code>android_build_config</code></a>.<li class="arg"><code>skip_crunch_pngs</code> (defaults to <code>False</code>) If <code>True</code>, PNGs in the APK are not crushed by aapt. This is equivalent to specifying<pre class="prettyprint lang-js">
  android {
      aaptOptions.useAaptPngCruncher = false
  }
  </pre>in gradle, or<pre class="prettyprint lang-xml">
  &lt;target name="-crunch">
      &lt;echo message="Skipping PNG optimization"/>
  &lt;/target>
  </pre>in ant. This can be useful if the PNGs have been optimised beforehand, as aapt would attempt to crush the optimised PNGs and end up increasing their size instead of decreasing it.<li class="arg"><code>banned_duplicate_resource_types</code> (defaults to <code>[]</code>) If <code>['string']</code> is used, the build will break if multiple string resources with the same name are added in an app's Android Resources. Resource names are name-spaced by resource type, this does not enforce unique names between multiple resource types. AAPT does not enforce this, but you can prevent easy-to-introduce resource bugs by enabling this.<li class="arg"><code>includes_vector_drawables</code> (defaults to <code>False</code>) When calling AAPT during the packaging process, pass the <code>--no-version-vectors</code> flag which ensures that any vector drawables which make use of the Android support library are backwards compatible with Android 4.4 and earlier.<li class="arg"><code>manifest_entries</code> (defaults to <code>{}</code>) Insert values into the packaged <code>AndroidManifest.xml</code> file. Valid values are <code>min_sdk_version</code>, <code>target_sdk_version</code>,<code>version_code</code>, <code>version_name</code>, and <code>debug_mode</code>. Example:<pre class="prettyprint lang-py">
  android_binary(
    # ... other args ...
    manifest_entries = {
        'version_code': 12,
        'version_name': '2.0',
        'min_sdk_version': 16,
        'target_sdk_version': 23,
        'debug_mode': True,
    }
  )
  </pre>This is equivalent to specifying<pre class="prettyprint lang-js">
  android {
      defaultConfig {
        versionCode 12
        versionName "2.0"
        minSdkVersion 16
        targetSdkVersion 23
      }
  }
  </pre>in gradle and building the debug <code>BuildType</code>. This is especially useful when combined with the <a href="/function/flatten_dicts.html"><code>flatten_dicts</code></a> function. This will allow you to share a default config amongst your rules, and override values as necessary.<li class="arg"><code>deps</code> (defaults to <code>[]</code>) List of build targets whose corresponding compiled Java code, Android resources, and native libraries will be included in the APK. From the transitive closure of these dependencies, the outputs of rules of the following type will be included in the APK:<ul><li><code>android_library()</code><li><code>android_resource()</code><li><code>cxx_library()</code><li><code>groovy_library()</code><li><code>java_library()</code><li><code>java_binary()</code><li><code>prebuilt_jar()</code><li><code>ndk_library()</code><li><code>prebuilt_native_library()</code></ul><li class="arg"><code>cpu_filters</code> (defaults to <code>[]</code>) The CPU architecture filter applied to the final apk. Could be a subset of <code>ARM</code>, <code>ARMV7</code>, <code>ARM64</code>, <code>X86</code>, <code>X86_64</code>, <code>MIPS</code>.<p><strong>Note</strong>: If you set this parameter, you must setup your NDK, otherwise BUCK build will fail. You can follow the Android SDK and NDK part of the <a href="/setup/install.html">install guide</a> to set it up.</p><li class="arg"><code>linear_alloc_hard_limit</code> (defaults to <code>4194304</code>) The size at which secondary dex files should be split when building an <a href="/article/exopackage.html">exopackage</a> in bytes.<p>It is set 4MB by default, because Android 2.3 has a LinearAlloc limit of 5MB and 1MB is taken up by the framework.  More recent versions of Android have a LinearAlloc limit of 8MB or 16MB, so if the APK is only targeted for versions newer than 2.3, a 7MB limit is safe to use.</p><li class="arg"><code>skip_proguard</code> (defaults to <code>False</code>) To produce a release build without running ProGuard set the<code>skip_proguard</code> flag to <code>True</code>. This will still cause ProGuard configuration files to be generated for use by other optimizers like Redex.<li class="arg"><code>visibility</code> (defaults to <code>[]</code>) List of <a href="/concept/build_target_pattern.html">build target patterns</a> that identify the build rules that can include this rule in its <code>deps</code>.<li class="arg"><code>licenses</code> (defaults to <code>[]</code>) Set of license files for this library.  To get the list of license files for a given <a href="/concept/build_rule.html">build rule</a> and all of its dependencies, you can use <a href="/command/query.html"><code>buck query</code></a>.</ul><h2>Examples</h2>Here is an example of an <code>android_binary()</code> rule that includes Android resources from one dependency and compiled Java code from another dependency:<pre class="prettyprint lang-py">
android_resource(
  name = 'res',
  res = 'res',
  assets = 'assets',
)

android_library(
  name = 'src',
  srcs = glob(['src/**/*.java']),
  deps = [
    ':res',
  ],
)

# Building this rule will produce a file named messenger.apk.
android_binary(
  name = 'messenger',
  manifest = 'AndroidManifest.xml',
  keystore = '//keystores:prod',
  package_type = 'release',
  proguard_config = 'proguard.cfg',
  deps = [
    ':res',
    ':src',
  ],
)
</pre></div></article><nav><h3>Getting Started</h3><ul><li class=""><a href="/about/overview.html">Overview</a></li><li class=""><a href="/setup/install.html">Downloading and Installing Buck</a></li><li class=""><a href="/setup/intellij_plugin_install.html">Installing the IntelliJ Plugin</a></li><li class=""><a href="/setup/getting_started.html">Getting Started</a></li><li class=""><a href="/article/exopackage.html">Exopackage</a></li><li class=""><a href="/article/query_cheat_sheet.html">Buck Query Cheat Sheet</a></li></ul><h3>About</h3><ul><li class=""><a href="/concept/what_makes_buck_so_fast.html">What Makes Buck so Fast?</a></li><li class=""><a href="/concept/troubleshooting.html">Troubleshooting</a></li><li class=""><a href="/about/performance_tuning.html">Performance Tuning</a></li><li class=""><a href="/concept/faq.html">FAQ</a></li><li class=""><a href="/presentations/index.html">Learn More (Buck Presentations)</a></li></ul><h3>Concepts</h3><ul><li class=""><a href="/concept/build_rule.html">Build Rule</a></li><li class=""><a href="/concept/build_target.html">Build Target</a></li><li class=""><a href="/concept/build_file.html">Build File</a></li><li class=""><a href="/concept/buckversion.html">.buckversion</a></li><li class=""><a href="/concept/nobuckcheck.html">.nobuckcheck</a></li><li class=""><a href="/concept/buckjavaargs.html">.buckjavaargs</a></li><li class=""><a href="/concept/buckconfig.html">.buckconfig</a></li><li class=""><a href="/concept/build_target_pattern.html">Build Target Pattern</a></li><li class=""><a href="/concept/visibility.html">Visibility</a></li><li class=""><a href="/concept/http_cache_api.html">HTTP Cache API</a></li><li class=""><a href="/concept/rule_keys.html">Rule Keys</a></li></ul><h3>Build Rules</h3><ul><li><strong>Core</strong></li><li class=""><a href="/rule/export_file.html">export_file()</a></li><li class=""><a href="/rule/genrule.html">genrule()</a></li><li class=""><a href="/rule/remote_file.html">remote_file()</a></li><li class=""><a href="/rule/worker_tool.html">worker_tool()</a></li><li class=""><a href="/rule/zip_file.html">zip_file()</a></li><li><strong>Android</strong></li><li class=""><a href="/rule/android_aar.html">android_aar()</a></li><li class="navActiveItem"><a href="/rule/android_binary.html">android_binary()</a></li><li class=""><a href="/rule/android_build_config.html">android_build_config()</a></li><li class=""><a href="/rule/android_instrumentation_apk.html">android_instrumentation_apk()</a></li><li class=""><a href="/rule/android_instrumentation_test.html">android_instrumentation_test()</a></li><li class=""><a href="/rule/android_library.html">android_library()</a></li><li class=""><a href="/rule/android_manifest.html">android_manifest()</a></li><li class=""><a href="/rule/android_prebuilt_aar.html">android_prebuilt_aar()</a></li><li class=""><a href="/rule/android_resource.html">android_resource()</a></li><li class=""><a href="/rule/apk_genrule.html">apk_genrule()</a></li><li class=""><a href="/rule/gen_aidl.html">gen_aidl()</a></li><li class=""><a href="/rule/keystore.html">keystore()</a></li><li class=""><a href="/rule/ndk_library.html">ndk_library()</a></li><li class=""><a href="/rule/prebuilt_jar.html">prebuilt_jar()</a></li><li class=""><a href="/rule/prebuilt_native_library.html">prebuilt_native_library()</a></li><li class=""><a href="/rule/project_config.html">project_config()</a></li><li><strong>CXX</strong></li><li class=""><a href="/rule/cxx_binary.html">cxx_binary()</a></li><li class=""><a href="/rule/cxx_library.html">cxx_library()</a></li><li class=""><a href="/rule/cxx_precompiled_header.html">cxx_precompiled_header()</a></li><li class=""><a href="/rule/cxx_test.html">cxx_test()</a></li><li class=""><a href="/rule/prebuilt_cxx_library.html">prebuilt_cxx_library()</a></li><li class=""><a href="/rule/prebuilt_cxx_library_group.html">prebuilt_cxx_library_group()</a></li><li><strong>D</strong></li><li class=""><a href="/rule/d_binary.html">d_binary()</a></li><li class=""><a href="/rule/d_library.html">d_library()</a></li><li class=""><a href="/rule/d_test.html">d_test()</a></li><li><strong>Go</strong></li><li class=""><a href="/rule/go_binary.html">go_binary()</a></li><li class=""><a href="/rule/go_library.html">go_library()</a></li><li class=""><a href="/rule/go_test.html">go_test()</a></li><li><strong>Groovy</strong></li><li class=""><a href="/rule/groovy_library.html">groovy_library()</a></li><li><strong>Halide</strong></li><li class=""><a href="/rule/halide_library.html">halide_library()</a></li><li><strong>Haskell</strong></li><li class=""><a href="/rule/haskell_binary.html">haskell_binary()</a></li><li class=""><a href="/rule/haskell_library.html">haskell_library()</a></li><li class=""><a href="/rule/prebuilt_haskell_library.html">prebuilt_haskell_library()</a></li><li><strong>iOS</strong></li><li class=""><a href="/rule/apple_asset_catalog.html">apple_asset_catalog()</a></li><li class=""><a href="/rule/apple_binary.html">apple_binary()</a></li><li class=""><a href="/rule/apple_bundle.html">apple_bundle()</a></li><li class=""><a href="/rule/apple_library.html">apple_library()</a></li><li class=""><a href="/rule/apple_package.html">apple_package()</a></li><li class=""><a href="/rule/apple_resource.html">apple_resource()</a></li><li class=""><a href="/rule/apple_test.html">apple_test()</a></li><li class=""><a href="/rule/core_data_model.html">core_data_model()</a></li><li><strong>Java</strong></li><li class=""><a href="/rule/java_binary.html">java_binary()</a></li><li class=""><a href="/rule/java_library.html">java_library()</a></li><li class=""><a href="/rule/java_test.html">java_test()</a></li><li class=""><a href="/rule/prebuilt_jar.html">prebuilt_jar()</a></li><li class=""><a href="/rule/prebuilt_native_library.html">prebuilt_native_library()</a></li><li><strong>Lua</strong></li><li class=""><a href="/rule/cxx_lua_extension.html">cxx_lua_extension()</a></li><li class=""><a href="/rule/lua_binary.html">lua_binary()</a></li><li class=""><a href="/rule/lua_library.html">lua_library()</a></li><li><strong>Python</strong></li><li class=""><a href="/rule/prebuilt_python_library.html">prebuilt_python_library()</a></li><li class=""><a href="/rule/python_binary.html">python_binary()</a></li><li class=""><a href="/rule/python_library.html">python_library()</a></li><li class=""><a href="/rule/python_test.html">python_test()</a></li><li><strong>Rust</strong></li><li class=""><a href="/rule/rust_binary.html">rust_binary()</a></li><li class=""><a href="/rule/rust_library.html">rust_library()</a></li><li class=""><a href="/rule/rust_test.html">rust_test()</a></li><li class=""><a href="/rule/prebuilt_rust_library.html">prebuilt_rust_library()</a></li><li><strong>.Net</strong></li><li class=""><a href="/rule/csharp_library.html">csharp_library()</a></li><li class=""><a href="/rule/prebuilt_dotnet_library.html">prebuilt_dotnet_library()</a></li></ul><h3>Functions</h3><ul><li class=""><a href="/function/add_build_file_dep.html">add_build_file_dep()</a></li><li class=""><a href="/function/allow_unsafe_import.html">allow_unsafe_import()</a></li><li class=""><a href="/function/flatten_dicts.html">flatten_dicts()</a></li><li class=""><a href="/function/glob.html">glob()</a></li><li class=""><a href="/function/include_defs.html">include_defs()</a></li><li class=""><a href="/function/read_config.html">read_config()</a></li><li class=""><a href="/function/subdir_glob.html">subdir_glob()</a></li><li class=""><a href="/function/string_parameter_macros.html">String Parameter Macros</a></li></ul><h3>Commands</h3><ul><li class=""><a href="/command/common_parameters.html">Common Parameters</a></li><li class=""><a href="/command/audit.html">buck audit</a></li><li class=""><a href="/command/autodeps.html">buck autodeps</a></li><li class=""><a href="/command/build.html">buck build</a></li><li class=""><a href="/command/clean.html">buck clean</a></li><li class=""><a href="/command/doctor.html">buck doctor</a></li><li class=""><a href="/command/fetch.html">buck fetch</a></li><li class=""><a href="/command/install.html">buck install</a></li><li class=""><a href="/command/project.html">buck project</a></li><li class=""><a href="/command/query.html">buck query</a></li><li class=""><a href="/command/run.html">buck run</a></li><li class=""><a href="/command/root.html">buck root</a></li><li class=""><a href="/command/server.html">buck server</a></li><li class=""><a href="/command/suggest.html">buck suggest</a></li><li class=""><a href="/command/targets.html">buck targets</a></li><li class=""><a href="/command/test.html">buck test</a></li><li class=""><a href="/command/uninstall.html">buck uninstall</a></li><li class=""><a href="/command/buckd.html">buckd</a></li></ul><h3>Extending Buck</h3><ul><li class=""><a href="/extending/macros.html">Custom Macros</a></li><li class=""><a href="/extending/rules.html">Custom Rules</a></li></ul></nav></div></section><footer><div class='width'>&copy; Copyright Facebook, 2013 -</div></footer><!-- Algolia Search Code --><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
docsearch({
  apiKey: 'c25b7174e8f6161ce5fdd44bb0b95081',
  indexName: 'buckbuild',
  inputSelector: '#algolia-doc-search',
  debug: false // Set debug to true if you want to inspect the dropdown
});
</script><!-- End Algolia Search Code --><script src="/google-code-prettify/prettify.js"></script><script>prettyPrint()</script></body></html>